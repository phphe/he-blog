[{"data":1,"prerenderedAt":373},["Reactive",2],{"content-query-cJSjOfUgxr":3},[4],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"title":9,"description":10,"date":11,"tags":12,"excerpt":15,"body":35,"_type":368,"_id":369,"_source":370,"_file":371,"_extension":372},"/zh/blog/nuxt3-i18n-setup","blog",false,"","配置Nuxt3和@nuxtjs/i18n多语言模块，及容易出错的地方","这几天心痒痒用 Nuxt3.7 重构了博客，使用@nuxtjs/i18n v8 配置多语言功能。配置过程中遇到了一些坑，写点文字记录一下。","2023-09-26 22:35",[13,14],"nuxt","tool",{"type":16,"children":17},"root",[18],{"type":19,"tag":20,"props":21,"children":22},"element","p",{},[23,26,33],{"type":24,"value":25},"text","这几天心痒痒用 Nuxt3.7 重构了博客，使用",{"type":19,"tag":27,"props":28,"children":30},"code",{"className":29},[],[31],{"type":24,"value":32},"@nuxtjs/i18n",{"type":24,"value":34}," v8 配置多语言功能。配置过程中遇到了一些坑，写点文字记录一下。",{"type":16,"children":36,"toc":363},[37,47,53,82,95,200,258,268,274,293,319,324,357],{"type":19,"tag":20,"props":38,"children":39},{},[40,41,46],{"type":24,"value":25},{"type":19,"tag":27,"props":42,"children":44},{"className":43},[],[45],{"type":24,"value":32},{"type":24,"value":34},{"type":19,"tag":48,"props":49,"children":51},"h2",{"id":50},"路由",[52],{"type":24,"value":50},{"type":19,"tag":20,"props":54,"children":55},{},[56,58,64,66,72,74,80],{"type":24,"value":57},"我想要为已经有的路由增加对应其他语言的带有语言前缀的路由，例如增加语言",{"type":19,"tag":27,"props":59,"children":61},{"className":60},[],[62],{"type":24,"value":63},"en",{"type":24,"value":65},"后，应该自动为首页注册路由",{"type":19,"tag":27,"props":67,"children":69},{"className":68},[],[70],{"type":24,"value":71},"/en",{"type":24,"value":73},"。按照官方文档配置后，其他功能都正常，就是路由没增加。顺带提一下，Nuxt 默认内置了页内开发工具，可以查看注册了哪些路由，点击页面上漂浮的 Nuxt 图标或在网页内按组合键",{"type":19,"tag":27,"props":75,"children":77},{"className":76},[],[78],{"type":24,"value":79},"Shift+Alt+D",{"type":24,"value":81},"打开。",{"type":19,"tag":20,"props":83,"children":84},{},[85,87,93],{"type":24,"value":86},"折腾了几个小时后还是成功了，至于为什么要这么做，那就不知道了。在",{"type":19,"tag":27,"props":88,"children":90},{"className":89},[],[91],{"type":24,"value":92},"nuxt.config.ts/js",{"type":24,"value":94},"中这样写：",{"type":19,"tag":96,"props":97,"children":101},"pre",{"className":98,"code":99,"language":100,"meta":8,"style":8},"language-ts shiki shiki-themes solarized-light github-dark monokai","i18n: {\n  locales: [\"en\", \"zh\"], // used in URL path prefix\n  defaultLocale: \"en\", // default locale of your project for Nuxt pages and routings\n}\n","ts",[102],{"type":19,"tag":27,"props":103,"children":104},{"__ignoreMap":8},[105,123,164,191],{"type":19,"tag":106,"props":107,"children":110},"span",{"class":108,"line":109},"line",1,[111,117],{"type":19,"tag":106,"props":112,"children":114},{"style":113},"--shiki-default:#657B83;--shiki-dark:#B392F0;--shiki-sepia:#F8F8F2",[115],{"type":24,"value":116},"i18n",{"type":19,"tag":106,"props":118,"children":120},{"style":119},"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[121],{"type":24,"value":122},": {\n",{"type":19,"tag":106,"props":124,"children":126},{"class":108,"line":125},2,[127,132,137,143,148,153,158],{"type":19,"tag":106,"props":128,"children":129},{"style":113},[130],{"type":24,"value":131},"  locales",{"type":19,"tag":106,"props":133,"children":134},{"style":119},[135],{"type":24,"value":136},": [",{"type":19,"tag":106,"props":138,"children":140},{"style":139},"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[141],{"type":24,"value":142},"\"en\"",{"type":19,"tag":106,"props":144,"children":145},{"style":119},[146],{"type":24,"value":147},", ",{"type":19,"tag":106,"props":149,"children":150},{"style":139},[151],{"type":24,"value":152},"\"zh\"",{"type":19,"tag":106,"props":154,"children":155},{"style":119},[156],{"type":24,"value":157},"], ",{"type":19,"tag":106,"props":159,"children":161},{"style":160},"--shiki-default:#93A1A1;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-default-font-style:italic;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit",[162],{"type":24,"value":163},"// used in URL path prefix\n",{"type":19,"tag":106,"props":165,"children":167},{"class":108,"line":166},3,[168,173,178,182,186],{"type":19,"tag":106,"props":169,"children":170},{"style":113},[171],{"type":24,"value":172},"  defaultLocale",{"type":19,"tag":106,"props":174,"children":175},{"style":119},[176],{"type":24,"value":177},": ",{"type":19,"tag":106,"props":179,"children":180},{"style":139},[181],{"type":24,"value":142},{"type":19,"tag":106,"props":183,"children":184},{"style":119},[185],{"type":24,"value":147},{"type":19,"tag":106,"props":187,"children":188},{"style":160},[189],{"type":24,"value":190},"// default locale of your project for Nuxt pages and routings\n",{"type":19,"tag":106,"props":192,"children":194},{"class":108,"line":193},4,[195],{"type":19,"tag":106,"props":196,"children":197},{"style":119},[198],{"type":24,"value":199},"}\n",{"type":19,"tag":20,"props":201,"children":202},{},[203,205,211,213,219,221,227,229,234,236,242,244,249,251,256],{"type":24,"value":204},"也就是说",{"type":19,"tag":27,"props":206,"children":208},{"className":207},[],[209],{"type":24,"value":210},"locales",{"type":24,"value":212},"和",{"type":19,"tag":27,"props":214,"children":216},{"className":215},[],[217],{"type":24,"value":218},"defaultLocale",{"type":24,"value":220},"要写在",{"type":19,"tag":27,"props":222,"children":224},{"className":223},[],[225],{"type":24,"value":226},"nuxt.config",{"type":24,"value":228},"里，其他",{"type":19,"tag":27,"props":230,"children":232},{"className":231},[],[233],{"type":24,"value":32},{"type":24,"value":235},"的配置我写在了",{"type":19,"tag":27,"props":237,"children":239},{"className":238},[],[240],{"type":24,"value":241},"i18n.config.ts",{"type":24,"value":243},"里。这样配置是可以正常工作的。之前我把",{"type":19,"tag":27,"props":245,"children":247},{"className":246},[],[248],{"type":24,"value":32},{"type":24,"value":250},"的配置全写在",{"type":19,"tag":27,"props":252,"children":254},{"className":253},[],[255],{"type":24,"value":241},{"type":24,"value":257},"里，就出现了上面的问题，即没有增加其他语言的路由。",{"type":19,"tag":20,"props":259,"children":260},{},[261,266],{"type":19,"tag":27,"props":262,"children":264},{"className":263},[],[265],{"type":24,"value":32},{"type":24,"value":267},"有几种路由策略，这里使用的是默认策略。",{"type":19,"tag":48,"props":269,"children":271},{"id":270},"nuxt-generate",[272],{"type":24,"value":273},"nuxt generate",{"type":19,"tag":20,"props":275,"children":276},{},[277,279,284,286,291],{"type":24,"value":278},"这几天的",{"type":19,"tag":27,"props":280,"children":282},{"className":281},[],[283],{"type":24,"value":32},{"type":24,"value":285},"版本有 bug，当执行",{"type":19,"tag":27,"props":287,"children":289},{"className":288},[],[290],{"type":24,"value":273},{"type":24,"value":292},"时会出错，安装最新版就好了。",{"type":19,"tag":96,"props":294,"children":298},{"className":295,"code":296,"language":297,"meta":8,"style":8},"language-json shiki shiki-themes solarized-light github-dark monokai","\"@nuxtjs/i18n\": \"npm:@nuxtjs/i18n-edge\"\n","json",[299],{"type":19,"tag":27,"props":300,"children":301},{"__ignoreMap":8},[302],{"type":19,"tag":106,"props":303,"children":304},{"class":108,"line":109},[305,310,314],{"type":19,"tag":106,"props":306,"children":307},{"style":139},[308],{"type":24,"value":309},"\"@nuxtjs/i18n\"",{"type":19,"tag":106,"props":311,"children":312},{"style":119},[313],{"type":24,"value":177},{"type":19,"tag":106,"props":315,"children":316},{"style":139},[317],{"type":24,"value":318},"\"npm:@nuxtjs/i18n-edge\"\n",{"type":19,"tag":48,"props":320,"children":322},{"id":321},"链接组件",[323],{"type":24,"value":321},{"type":19,"tag":20,"props":325,"children":326},{},[327,332,334,340,342,348,350,355],{"type":19,"tag":27,"props":328,"children":330},{"className":329},[],[331],{"type":24,"value":32},{"type":24,"value":333},"提供了函数",{"type":19,"tag":27,"props":335,"children":337},{"className":336},[],[338],{"type":24,"value":339},"useLocalePath",{"type":24,"value":341},"以翻译链接。但是每个使用到的地方都要引入一次太麻烦了。我就尝试写一个可以自动翻译链接的组件，写一半的时候发现它已经提供了，叫做",{"type":19,"tag":27,"props":343,"children":345},{"className":344},[],[346],{"type":24,"value":347},"NuxtLinkLocale",{"type":24,"value":349},"。我想吐槽的是，这个组件在",{"type":19,"tag":27,"props":351,"children":353},{"className":352},[],[354],{"type":24,"value":339},{"type":24,"value":356},"函数的页面没有提到，也不在左边栏的导航菜单里。",{"type":19,"tag":358,"props":359,"children":360},"style",{},[361],{"type":24,"value":362},"html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":8,"searchDepth":125,"depth":125,"links":364},[365,366,367],{"id":50,"depth":125,"text":50},{"id":270,"depth":125,"text":273},{"id":321,"depth":125,"text":321},"markdown","content:zh:blog:nuxt3 i18n setup.md","content","zh/blog/nuxt3 i18n setup.md","md",1706852441124]