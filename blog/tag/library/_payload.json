[{"data":1,"prerenderedAt":531},["Reactive",2],{"content-query-PNhLbjhvw6":3},[4],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"title":9,"description":10,"date":11,"tags":12,"excerpt":16,"body":26,"_type":526,"_id":527,"_source":528,"_file":529,"_extension":530},"/blog/library-entries-and-type-moule","blog",false,"","npm library type module and exports","The fields of package.json for npm library.","2024-01-31 23:09",[13,14,15],"npm","library","frontend",{"type":17,"children":18},"root",[19],{"type":20,"tag":21,"props":22,"children":23},"element","p",{},[24],{"type":25,"value":10},"text",{"type":17,"children":27,"toc":521},[28,32,39,53,58,63,286,291,296,301,307,502,515],{"type":20,"tag":21,"props":29,"children":30},{},[31],{"type":25,"value":10},{"type":20,"tag":33,"props":34,"children":36},"h2",{"id":35},"main-module",[37],{"type":25,"value":38},"main & module",{"type":20,"tag":21,"props":40,"children":41},{},[42,44,51],{"type":25,"value":43},"Previously, we used \"main\" and \"module\". \"main\" refers to the main entry point, usually in cjs format. \"module\" refers to the esm entry point. Note that only bundling tools like webpack and rollup support \"module\", while Node.js only supports \"main\". If you directly run the node command like ",{"type":20,"tag":45,"props":46,"children":48},"code",{"className":47},[],[49],{"type":25,"value":50},"node your.js",{"type":25,"value":52},", and your js file imports a library, Node.js will only call the file corresponding to the library's \"main\" field.",{"type":20,"tag":33,"props":54,"children":56},{"id":55},"exports",[57],{"type":25,"value":55},{"type":20,"tag":21,"props":59,"children":60},{},[61],{"type":25,"value":62},"\"exports\" can export multiple entry points.",{"type":20,"tag":64,"props":65,"children":69},"pre",{"className":66,"code":67,"language":68,"meta":8,"style":8},"language-json shiki shiki-themes solarized-light github-dark monokai","{\n  \"exports\": {\n    \".\": {\n      \"import\": \"./src/main-esm.js\",\n      \"require\": \"./src/main-cjs.js\",\n      \"types\": \"./src/main.d.ts\"\n    },\n    \"./module-a\": {\n      \"import\": \"./src/module-a-esm.js\",\n      \"require\": \"./src/module-a-cjs.js\",\n      \"types\": \"./src/module-a.d.ts\"\n    }\n  }\n}\n","json",[70],{"type":20,"tag":45,"props":71,"children":72},{"__ignoreMap":8},[73,85,100,113,138,160,178,187,200,221,242,259,268,277],{"type":20,"tag":74,"props":75,"children":78},"span",{"class":76,"line":77},"line",1,[79],{"type":20,"tag":74,"props":80,"children":82},{"style":81},"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[83],{"type":25,"value":84},"{\n",{"type":20,"tag":74,"props":86,"children":88},{"class":76,"line":87},2,[89,95],{"type":20,"tag":74,"props":90,"children":92},{"style":91},"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[93],{"type":25,"value":94},"  \"exports\"",{"type":20,"tag":74,"props":96,"children":97},{"style":81},[98],{"type":25,"value":99},": {\n",{"type":20,"tag":74,"props":101,"children":103},{"class":76,"line":102},3,[104,109],{"type":20,"tag":74,"props":105,"children":106},{"style":91},[107],{"type":25,"value":108},"    \".\"",{"type":20,"tag":74,"props":110,"children":111},{"style":81},[112],{"type":25,"value":99},{"type":20,"tag":74,"props":114,"children":116},{"class":76,"line":115},4,[117,122,127,133],{"type":20,"tag":74,"props":118,"children":119},{"style":91},[120],{"type":25,"value":121},"      \"import\"",{"type":20,"tag":74,"props":123,"children":124},{"style":81},[125],{"type":25,"value":126},": ",{"type":20,"tag":74,"props":128,"children":130},{"style":129},"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2",[131],{"type":25,"value":132},"\"./src/main-esm.js\"",{"type":20,"tag":74,"props":134,"children":135},{"style":81},[136],{"type":25,"value":137},",\n",{"type":20,"tag":74,"props":139,"children":141},{"class":76,"line":140},5,[142,147,151,156],{"type":20,"tag":74,"props":143,"children":144},{"style":91},[145],{"type":25,"value":146},"      \"require\"",{"type":20,"tag":74,"props":148,"children":149},{"style":81},[150],{"type":25,"value":126},{"type":20,"tag":74,"props":152,"children":153},{"style":129},[154],{"type":25,"value":155},"\"./src/main-cjs.js\"",{"type":20,"tag":74,"props":157,"children":158},{"style":81},[159],{"type":25,"value":137},{"type":20,"tag":74,"props":161,"children":163},{"class":76,"line":162},6,[164,169,173],{"type":20,"tag":74,"props":165,"children":166},{"style":91},[167],{"type":25,"value":168},"      \"types\"",{"type":20,"tag":74,"props":170,"children":171},{"style":81},[172],{"type":25,"value":126},{"type":20,"tag":74,"props":174,"children":175},{"style":129},[176],{"type":25,"value":177},"\"./src/main.d.ts\"\n",{"type":20,"tag":74,"props":179,"children":181},{"class":76,"line":180},7,[182],{"type":20,"tag":74,"props":183,"children":184},{"style":81},[185],{"type":25,"value":186},"    },\n",{"type":20,"tag":74,"props":188,"children":190},{"class":76,"line":189},8,[191,196],{"type":20,"tag":74,"props":192,"children":193},{"style":91},[194],{"type":25,"value":195},"    \"./module-a\"",{"type":20,"tag":74,"props":197,"children":198},{"style":81},[199],{"type":25,"value":99},{"type":20,"tag":74,"props":201,"children":203},{"class":76,"line":202},9,[204,208,212,217],{"type":20,"tag":74,"props":205,"children":206},{"style":91},[207],{"type":25,"value":121},{"type":20,"tag":74,"props":209,"children":210},{"style":81},[211],{"type":25,"value":126},{"type":20,"tag":74,"props":213,"children":214},{"style":129},[215],{"type":25,"value":216},"\"./src/module-a-esm.js\"",{"type":20,"tag":74,"props":218,"children":219},{"style":81},[220],{"type":25,"value":137},{"type":20,"tag":74,"props":222,"children":224},{"class":76,"line":223},10,[225,229,233,238],{"type":20,"tag":74,"props":226,"children":227},{"style":91},[228],{"type":25,"value":146},{"type":20,"tag":74,"props":230,"children":231},{"style":81},[232],{"type":25,"value":126},{"type":20,"tag":74,"props":234,"children":235},{"style":129},[236],{"type":25,"value":237},"\"./src/module-a-cjs.js\"",{"type":20,"tag":74,"props":239,"children":240},{"style":81},[241],{"type":25,"value":137},{"type":20,"tag":74,"props":243,"children":245},{"class":76,"line":244},11,[246,250,254],{"type":20,"tag":74,"props":247,"children":248},{"style":91},[249],{"type":25,"value":168},{"type":20,"tag":74,"props":251,"children":252},{"style":81},[253],{"type":25,"value":126},{"type":20,"tag":74,"props":255,"children":256},{"style":129},[257],{"type":25,"value":258},"\"./src/module-a.d.ts\"\n",{"type":20,"tag":74,"props":260,"children":262},{"class":76,"line":261},12,[263],{"type":20,"tag":74,"props":264,"children":265},{"style":81},[266],{"type":25,"value":267},"    }\n",{"type":20,"tag":74,"props":269,"children":271},{"class":76,"line":270},13,[272],{"type":20,"tag":74,"props":273,"children":274},{"style":81},[275],{"type":25,"value":276},"  }\n",{"type":20,"tag":74,"props":278,"children":280},{"class":76,"line":279},14,[281],{"type":20,"tag":74,"props":282,"children":283},{"style":81},[284],{"type":25,"value":285},"}\n",{"type":20,"tag":21,"props":287,"children":288},{},[289],{"type":25,"value":290},"\".\" represents the main entry point, which is the \"main\" and \"module\" mentioned above. The \"import\" field in the child level refers to the esm file, the \"require\" field refers to the cjs file, and the \"types\" field refers to the type definition file.",{"type":20,"tag":21,"props":292,"children":293},{},[294],{"type":25,"value":295},"Unfortunately, \"exports\" is supported by Node.js and major bundling tools, but not by the current stable version of TypeScript (4.5). TypeScript 4.7 already supports it, but the built-in version of vscode is 4.5. So when using vscode, the type definition files in \"exports\" cannot be found.",{"type":20,"tag":21,"props":297,"children":298},{},[299],{"type":25,"value":300},"Therefore, if your library has multiple entry points and each entry point has its own type definition file, I suggest you not to do it this way, but to publish them as different npm libraries.",{"type":20,"tag":33,"props":302,"children":304},{"id":303},"example-packagejson",[305],{"type":25,"value":306},"Example package.json",{"type":20,"tag":64,"props":308,"children":310},{"className":66,"code":309,"language":68,"meta":8,"style":8},"{\n  \"type\": \"module\",\n  \"main\": \"./src/index.cjs\",\n  \"module\": \"./src/index.js\",\n  \"types\": \"./src/index.d.ts\",\n  \"exports\": {\n    \".\": {\n      \"require\": \"./src/index.cjs\",\n      \"import\": \"./src/index.js\",\n      \"types\": \"./src/index.d.ts\"\n    }\n  }\n}\n",[311],{"type":20,"tag":45,"props":312,"children":313},{"__ignoreMap":8},[314,321,342,363,384,405,416,427,446,465,481,488,495],{"type":20,"tag":74,"props":315,"children":316},{"class":76,"line":77},[317],{"type":20,"tag":74,"props":318,"children":319},{"style":81},[320],{"type":25,"value":84},{"type":20,"tag":74,"props":322,"children":323},{"class":76,"line":87},[324,329,333,338],{"type":20,"tag":74,"props":325,"children":326},{"style":91},[327],{"type":25,"value":328},"  \"type\"",{"type":20,"tag":74,"props":330,"children":331},{"style":81},[332],{"type":25,"value":126},{"type":20,"tag":74,"props":334,"children":335},{"style":129},[336],{"type":25,"value":337},"\"module\"",{"type":20,"tag":74,"props":339,"children":340},{"style":81},[341],{"type":25,"value":137},{"type":20,"tag":74,"props":343,"children":344},{"class":76,"line":102},[345,350,354,359],{"type":20,"tag":74,"props":346,"children":347},{"style":91},[348],{"type":25,"value":349},"  \"main\"",{"type":20,"tag":74,"props":351,"children":352},{"style":81},[353],{"type":25,"value":126},{"type":20,"tag":74,"props":355,"children":356},{"style":129},[357],{"type":25,"value":358},"\"./src/index.cjs\"",{"type":20,"tag":74,"props":360,"children":361},{"style":81},[362],{"type":25,"value":137},{"type":20,"tag":74,"props":364,"children":365},{"class":76,"line":115},[366,371,375,380],{"type":20,"tag":74,"props":367,"children":368},{"style":91},[369],{"type":25,"value":370},"  \"module\"",{"type":20,"tag":74,"props":372,"children":373},{"style":81},[374],{"type":25,"value":126},{"type":20,"tag":74,"props":376,"children":377},{"style":129},[378],{"type":25,"value":379},"\"./src/index.js\"",{"type":20,"tag":74,"props":381,"children":382},{"style":81},[383],{"type":25,"value":137},{"type":20,"tag":74,"props":385,"children":386},{"class":76,"line":140},[387,392,396,401],{"type":20,"tag":74,"props":388,"children":389},{"style":91},[390],{"type":25,"value":391},"  \"types\"",{"type":20,"tag":74,"props":393,"children":394},{"style":81},[395],{"type":25,"value":126},{"type":20,"tag":74,"props":397,"children":398},{"style":129},[399],{"type":25,"value":400},"\"./src/index.d.ts\"",{"type":20,"tag":74,"props":402,"children":403},{"style":81},[404],{"type":25,"value":137},{"type":20,"tag":74,"props":406,"children":407},{"class":76,"line":162},[408,412],{"type":20,"tag":74,"props":409,"children":410},{"style":91},[411],{"type":25,"value":94},{"type":20,"tag":74,"props":413,"children":414},{"style":81},[415],{"type":25,"value":99},{"type":20,"tag":74,"props":417,"children":418},{"class":76,"line":180},[419,423],{"type":20,"tag":74,"props":420,"children":421},{"style":91},[422],{"type":25,"value":108},{"type":20,"tag":74,"props":424,"children":425},{"style":81},[426],{"type":25,"value":99},{"type":20,"tag":74,"props":428,"children":429},{"class":76,"line":189},[430,434,438,442],{"type":20,"tag":74,"props":431,"children":432},{"style":91},[433],{"type":25,"value":146},{"type":20,"tag":74,"props":435,"children":436},{"style":81},[437],{"type":25,"value":126},{"type":20,"tag":74,"props":439,"children":440},{"style":129},[441],{"type":25,"value":358},{"type":20,"tag":74,"props":443,"children":444},{"style":81},[445],{"type":25,"value":137},{"type":20,"tag":74,"props":447,"children":448},{"class":76,"line":202},[449,453,457,461],{"type":20,"tag":74,"props":450,"children":451},{"style":91},[452],{"type":25,"value":121},{"type":20,"tag":74,"props":454,"children":455},{"style":81},[456],{"type":25,"value":126},{"type":20,"tag":74,"props":458,"children":459},{"style":129},[460],{"type":25,"value":379},{"type":20,"tag":74,"props":462,"children":463},{"style":81},[464],{"type":25,"value":137},{"type":20,"tag":74,"props":466,"children":467},{"class":76,"line":223},[468,472,476],{"type":20,"tag":74,"props":469,"children":470},{"style":91},[471],{"type":25,"value":168},{"type":20,"tag":74,"props":473,"children":474},{"style":81},[475],{"type":25,"value":126},{"type":20,"tag":74,"props":477,"children":478},{"style":129},[479],{"type":25,"value":480},"\"./src/index.d.ts\"\n",{"type":20,"tag":74,"props":482,"children":483},{"class":76,"line":244},[484],{"type":20,"tag":74,"props":485,"children":486},{"style":81},[487],{"type":25,"value":267},{"type":20,"tag":74,"props":489,"children":490},{"class":76,"line":261},[491],{"type":20,"tag":74,"props":492,"children":493},{"style":81},[494],{"type":25,"value":276},{"type":20,"tag":74,"props":496,"children":497},{"class":76,"line":270},[498],{"type":20,"tag":74,"props":499,"children":500},{"style":81},[501],{"type":25,"value":285},{"type":20,"tag":21,"props":503,"children":504},{},[505,507,513],{"type":25,"value":506},"Because we used ",{"type":20,"tag":45,"props":508,"children":510},{"className":509},[],[511],{"type":25,"value":512},"\"type\": \"module\"",{"type":25,"value":514},", the exported cjs file has the 'cjs' extension.",{"type":20,"tag":516,"props":517,"children":518},"style",{},[519],{"type":25,"value":520},"html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":8,"searchDepth":87,"depth":87,"links":522},[523,524,525],{"id":35,"depth":87,"text":38},{"id":55,"depth":87,"text":55},{"id":303,"depth":87,"text":306},"markdown","content:blog:library entries and type moule.md","content","blog/library entries and type moule.md","md",1706852441183]