{"_path":"/zh/blog/conventional-changelog-for-lerna-5-and-6","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Lerna 5/6 配置对话式更新日志（Conventional Changelog）","description":"配置lerna，并增加对话式更新日志（Conventional Changelog）。","date":"2023-03-02 01:09","tags":["lerna","tool"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"之前，我使用"},{"type":"element","tag":"a","props":{"href":"https://github.com/atlassian/cz-lerna-changelog","rel":["nofollow"]},"children":[{"type":"text","value":"cz-lerna-changelog"}]},{"type":"text","value":"。问题是这个库很久不更新了，而且仅适用于 lerna 3 及更早版本。所以我创建了"},{"type":"element","tag":"a","props":{"href":"https://github.com/phphe/cz-conventional-changelog-lerna","rel":["nofollow"]},"children":[{"type":"text","value":"cz-conventional-changelog-lerna"}]},{"type":"text","value":"。它适用于 lerna 5 及以后的版本。"}]},{"type":"element","tag":"h2","props":{"id":"使用示例"},"children":[{"type":"text","value":"使用示例"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"项目根目录下的 package.json"}]},{"type":"element","tag":"pre","props":{"className":"language-json shiki shiki-themes solarized-light github-dark monokai","code":"{\n  \"name\": \"root\",\n  \"private\": true,\n  \"workspaces\": [\"packages/*\"],\n  \"devDependencies\": {\n    \"commitizen\": \"^4.1.2\",\n    \"cz-conventional-changelog-lerna\": \"^0.1.0\",\n    \"lerna\": \"^5.0.0\"\n  },\n  \"scripts\": {\n    \"commit\": \"cz\",\n    \"commit-all\": \"git add . && cz\"\n  },\n  \"config\": {\n    \"commitizen\": {\n      \"path\": \"./node_modules/cz-conventional-changelog-lerna\"\n    }\n  }\n}\n","language":"json","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"name\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"root\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"private\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B58900;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"true"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"workspaces\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"packages/*\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"devDependencies\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"commitizen\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"^4.1.2\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"cz-conventional-changelog-lerna\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"^0.1.0\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"lerna\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"^5.0.0\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"scripts\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"commit\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"cz\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"commit-all\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"git add . && cz\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"config\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"commitizen\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"      \"path\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"./node_modules/cz-conventional-changelog-lerna\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"lerna.json"}]},{"type":"element","tag":"pre","props":{"className":"language-json shiki shiki-themes solarized-light github-dark monokai","code":"{\n  \"packages\": [\"packages/*\"],\n  \"command\": {\n    \"version\": {\n      \"conventionalCommits\": true\n    }\n  },\n  \"version\": \"independent\"\n}\n","language":"json","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"{\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"packages\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"packages/*\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"command\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"    \"version\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"      \"conventionalCommits\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B58900;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"},"children":[{"type":"text","value":"true\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"    }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#859900;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"},"children":[{"type":"text","value":"  \"version\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2"},"children":[{"type":"text","value":"\"independent\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"提交 git commit 时，首先添加更改到缓冲区（git add），然后执行"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"npm run commit"}]},{"type":"text","value":"，根据提示填写信息并完成提交。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"执行"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"lerna version"}]},{"type":"text","value":"或"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"lerna publish"}]},{"type":"text","value":"时会在 package 目录自动生成"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"CHANGELOG.md"}]},{"type":"text","value":". 可以参考我的项目: "},{"type":"element","tag":"a","props":{"href":"https://github.com/phphe/he-tree","rel":["nofollow"]},"children":[{"type":"text","value":"he-tree: Vue 可拖拽树组件"}]},{"type":"text","value":"."}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"使用示例","depth":2,"text":"使用示例"}]}},"_type":"markdown","_id":"content:zh:blog:Conventional Changelog for Lerna 5 and 6.md","_source":"content","_file":"zh/blog/Conventional Changelog for Lerna 5 and 6.md","_extension":"md"}