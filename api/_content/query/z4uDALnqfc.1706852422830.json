{"_path":"/zh/blog/nuxt3-i18n-setup","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"配置Nuxt3和@nuxtjs/i18n多语言模块，及容易出错的地方","description":"这几天心痒痒用 Nuxt3.7 重构了博客，使用@nuxtjs/i18n v8 配置多语言功能。配置过程中遇到了一些坑，写点文字记录一下。","date":"2023-09-26 22:35","tags":["nuxt","tool"],"excerpt":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这几天心痒痒用 Nuxt3.7 重构了博客，使用"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxtjs/i18n"}]},{"type":"text","value":" v8 配置多语言功能。配置过程中遇到了一些坑，写点文字记录一下。"}]}]},"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这几天心痒痒用 Nuxt3.7 重构了博客，使用"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxtjs/i18n"}]},{"type":"text","value":" v8 配置多语言功能。配置过程中遇到了一些坑，写点文字记录一下。"}]},{"type":"element","tag":"h2","props":{"id":"路由"},"children":[{"type":"text","value":"路由"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"我想要为已经有的路由增加对应其他语言的带有语言前缀的路由，例如增加语言"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"en"}]},{"type":"text","value":"后，应该自动为首页注册路由"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/en"}]},{"type":"text","value":"。按照官方文档配置后，其他功能都正常，就是路由没增加。顺带提一下，Nuxt 默认内置了页内开发工具，可以查看注册了哪些路由，点击页面上漂浮的 Nuxt 图标或在网页内按组合键"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Shift+Alt+D"}]},{"type":"text","value":"打开。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"折腾了几个小时后还是成功了，至于为什么要这么做，那就不知道了。在"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config.ts/js"}]},{"type":"text","value":"中这样写："}]},{"type":"element","tag":"pre","props":{"className":"language-ts shiki shiki-themes solarized-light github-dark monokai","code":"i18n: {\n  locales: [\"en\", \"zh\"], // used in URL path prefix\n  defaultLocale: \"en\", // default locale of your project for Nuxt pages and routings\n}\n","language":"ts","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#B392F0;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"i18n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#B392F0;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  locales"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"en\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"zh\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"], "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#93A1A1;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-default-font-style:italic;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit"},"children":[{"type":"text","value":"// used in URL path prefix\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#B392F0;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"  defaultLocale"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"en\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#93A1A1;--shiki-dark:#6A737D;--shiki-sepia:#88846F;--shiki-default-font-style:italic;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:inherit"},"children":[{"type":"text","value":"// default locale of your project for Nuxt pages and routings\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"也就是说"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"locales"}]},{"type":"text","value":"和"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"defaultLocale"}]},{"type":"text","value":"要写在"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config"}]},{"type":"text","value":"里，其他"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxtjs/i18n"}]},{"type":"text","value":"的配置我写在了"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"i18n.config.ts"}]},{"type":"text","value":"里。这样配置是可以正常工作的。之前我把"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxtjs/i18n"}]},{"type":"text","value":"的配置全写在"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"i18n.config.ts"}]},{"type":"text","value":"里，就出现了上面的问题，即没有增加其他语言的路由。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxtjs/i18n"}]},{"type":"text","value":"有几种路由策略，这里使用的是默认策略。"}]},{"type":"element","tag":"h2","props":{"id":"nuxt-generate"},"children":[{"type":"text","value":"nuxt generate"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"这几天的"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxtjs/i18n"}]},{"type":"text","value":"版本有 bug，当执行"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt generate"}]},{"type":"text","value":"时会出错，安装最新版就好了。"}]},{"type":"element","tag":"pre","props":{"className":"language-json shiki shiki-themes solarized-light github-dark monokai","code":"\"@nuxtjs/i18n\": \"npm:@nuxtjs/i18n-edge\"\n","language":"json","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"@nuxtjs/i18n\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#657B83;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#2AA198;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"},"children":[{"type":"text","value":"\"npm:@nuxtjs/i18n-edge\"\n"}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"链接组件"},"children":[{"type":"text","value":"链接组件"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxtjs/i18n"}]},{"type":"text","value":"提供了函数"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"useLocalePath"}]},{"type":"text","value":"以翻译链接。但是每个使用到的地方都要引入一次太麻烦了。我就尝试写一个可以自动翻译链接的组件，写一半的时候发现它已经提供了，叫做"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"NuxtLinkLocale"}]},{"type":"text","value":"。我想吐槽的是，这个组件在"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"useLocalePath"}]},{"type":"text","value":"函数的页面没有提到，也不在左边栏的导航菜单里。"}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"路由","depth":2,"text":"路由"},{"id":"nuxt-generate","depth":2,"text":"nuxt generate"},{"id":"链接组件","depth":2,"text":"链接组件"}]}},"_type":"markdown","_id":"content:zh:blog:nuxt3 i18n setup.md","_source":"content","_file":"zh/blog/nuxt3 i18n setup.md","_extension":"md"}